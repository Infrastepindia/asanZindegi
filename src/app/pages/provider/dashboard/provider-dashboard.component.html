<section class="py-5">
  <!-- <div *ngIf="isLoading" class="container py-5">
    <div class="text-center">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-secondary">Loading your dashboard...</p>
      <p class="small text-muted mt-2">If this takes too long, please refresh the page</p>
    </div>
  </div>-->

  <div class="container" *ngIf="acc as a">
    <div class="row g-4">
      <div class="col-lg-8">
        <!-- Company Logo and Account Information Card -->
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <h2 class="h5 mb-0 heading-cta">Your Provider Account</h2>
              <a routerLink="/provider/edit" class="btn btn-sm btn-primary">
                <i class="icon me-1">‚úèÔ∏è</i> Edit Details
              </a>
            </div>

            <!-- Company Logo Section -->
            <div class="company-logo-section mb-4 pb-4 border-bottom">
              <h3 class="h6 mb-3">Company Logo</h3>
              <div class="logo-container">
                <img
                  *ngIf="getCompanyLogo(); else logoPlaceholder"
                  [src]="getCompanyLogo()"
                  alt="Company Logo"
                  class="company-logo-image"
                />
                <ng-template #logoPlaceholder>
                  <div class="logo-placeholder">
                    <div class="placeholder-icon">üè¢</div>
                    <p class="placeholder-text">No logo uploaded</p>
                  </div>
                </ng-template>
              </div>
            </div>

            <!-- Company Information Section -->
            <div class="company-info-section">
              <h3 class="h6 mb-3">Company Information</h3>
              <div class="small text-secondary mb-3">
                Created {{ a.createdAt | date: 'mediumDate' }}
              </div>
              <div *ngIf="isCompany; else ind" class="account-info">
                <div class="mb-2">
                  <strong>Company:</strong>
                  <span>{{ company?.companyName || 'N/A' }}</span>
                </div>
                <div class="mb-2">
                  <strong>Primary Contact:</strong>
                  <span>{{ company?.contactName || 'N/A' }}</span>
                </div>
                <div class="mb-2" *ngIf="a.email">
                  <strong>Email:</strong>
                  <span>{{ a.email }}</span>
                </div>
                <div class="mb-2" *ngIf="a.phone">
                  <strong>Phone:</strong>
                  <span>{{ a.phone }}</span>
                </div>
                <div class="mb-2" *ngIf="company?.verification as verification">
                  <strong>Verification Status:</strong>
                  <span
                    class="verification-badge"
                    [ngClass]="'status-' + verification.status.toLowerCase()"
                  >
                    {{ verification.status }}
                  </span>
                </div>
              </div>
              <ng-template #ind>
                <div class="account-info">
                  <div class="mb-2">
                    <strong>Name:</strong>
                    <span>{{ individual?.fullName || 'N/A' }}</span>
                  </div>
                  <div class="mb-2" *ngIf="a.email">
                    <strong>Email:</strong>
                    <span>{{ a.email }}</span>
                  </div>
                  <div class="mb-2" *ngIf="a.phone">
                    <strong>Phone:</strong>
                    <span>{{ a.phone }}</span>
                  </div>
                </div>
              </ng-template>
            </div>
          </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row g-3 mb-4" *ngIf="providerAds.length > 0">
          <div class="col-md-4">
            <div class="stat-card">
              <div class="stat-value">{{ getTotalAds() }}</div>
              <div class="stat-label">Active Ads</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="stat-card">
              <div class="stat-value">{{ getTotalViews() }}</div>
              <div class="stat-label">Total Views</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="stat-card">
              <div class="stat-value">{{ getAverageRating() }}</div>
              <div class="stat-label">Average Rating</div>
            </div>
          </div>
        </div>

        <!-- Provider Categories Section -->
        <div class="card border-0 shadow-sm mb-4" *ngIf="getProviderCategories().length > 0">
          <div class="card-body p-4">
            <h3 class="h6 mb-3">Service Categories</h3>
            <div class="categories-list">
              <span class="category-badge" *ngFor="let cat of getProviderCategories()">
                {{ cat }}
              </span>
            </div>
          </div>
        </div>

        <!-- Advertisement Images Gallery Section -->
        <div class="card border-0 shadow-sm mb-4" *ngIf="providerAds.length > 0">
          <div class="card-body p-4">
            <h3 class="h6 mb-4">Advertisement Images</h3>
            <div class="ad-images-gallery">
              <div class="ad-image-item" *ngFor="let ad of providerAds">
                <div class="ad-image-wrapper">
                  <img
                    *ngIf="ad.cover"
                    [src]="ad.cover"
                    [alt]="ad.title"
                    class="ad-gallery-image"
                  />
                  <div *ngIf="!ad.cover" class="ad-image-placeholder">
                    <div class="placeholder-icon">üì∑</div>
                  </div>
                  <div class="ad-image-overlay">
                    <div class="ad-title-overlay">{{ ad.title || 'Untitled Service' }}</div>
                    <div class="ad-category-overlay">{{ ad.category }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Advertisement Details Section -->
        <div class="card border-0 shadow-sm" *ngIf="providerAds.length > 0">
          <div class="card-body p-4">
            <h3 class="h6 mb-4">Advertisement Details</h3>
            <div class="ads-grid">
              <div class="ad-item" *ngFor="let ad of providerAds">
                <div class="ad-cover">
                  <img *ngIf="ad.cover" [src]="ad.cover" [alt]="ad.title" />
                  <div *ngIf="!ad.cover" class="ad-placeholder">No Image</div>
                  <span class="ad-type-badge">{{ ad.type }}</span>
                  <span
                    class="ad-status-badge"
                    [ngClass]="ad.verified ? 'status-active' : 'status-inactive'"
                  >
                    {{ ad.verified ? 'Active' : 'Inactive' }}
                  </span>
                </div>
                <div class="ad-content">
                  <h4 class="ad-title">{{ ad.title || 'Untitled Service' }}</h4>
                  <p class="ad-description">{{ ad.category }}</p>
                  <p class="ad-details" *ngIf="ad.availabilityHours">
                    <i class="icon">üïê</i> {{ ad.availabilityHours }}
                  </p>
                  <div class="ad-meta">
                    <span class="meta-item">
                      <strong class="price-value">‚Çπ{{ ad.price | number: '0.0-2' }}</strong>
                      <span *ngIf="ad.unit" class="price-unit">{{ ad.unit }}</span>
                    </span>
                    <span class="meta-item" *ngIf="ad.location">
                      <i class="icon">üìç</i> {{ ad.location }}
                    </span>
                    <span class="meta-item">
                      <i class="icon">üìÖ</i> {{ ad.date | date: 'shortDate' }}
                    </span>
                  </div>
                  <div class="ad-stats">
                    <span class="stat-item" *ngIf="ad.views > 0">
                      <i class="icon">üëÅÔ∏è</i> {{ ad.views }} views
                    </span>
                    <span class="stat-item" *ngIf="ad.rating">
                      <i class="icon">‚≠ê</i> {{ ad.rating }}/5
                    </span>
                    <span class="stat-item" *ngIf="ad.verified">
                      <i class="icon">‚úì</i> {{ ad.verifiedType }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Ads Message -->
        <div class="card border-0 shadow-sm" *ngIf="providerAds.length === 0">
          <div class="card-body p-4 text-center">
            <p class="text-secondary mb-3">You haven't posted any advertisements yet.</p>
            <a routerLink="/post-ad" class="btn btn-join btn-lg">Create Your First Ad</a>
          </div>
        </div>

        <!-- Media Files Section -->
        <div class="card border-0 shadow-sm" *ngIf="getFileCategories().length > 0">
          <div class="card-body p-4">
            <h3 class="h6 mb-4">Media Files</h3>
            <div class="media-sections">
              <div class="media-category" *ngFor="let category of getFileCategories()">
                <h4 class="media-category-title">{{ category }}</h4>
                <div class="media-grid">
                  <div class="media-item" *ngFor="let file of getFilesByCategory(category)">
                    <div class="media-preview">
                      <img [src]="getImageUrl(file)" [alt]="file.fileName" class="media-image" />
                    </div>
                    <div class="media-info">
                      <p class="media-filename">{{ file.fileName }}</p>
                      <p class="media-type">{{ file.fileType }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- <div class="card border-0 shadow-sm" *ngIf="isCompany">
          <div class="card-body p-4">
            <h3 class="h6 mb-3">Personnel</h3>
            <form class="row g-2 align-items-end" (submit)="addPersonnel($event)">
              <div class="col-md-4">
                <label class="form-label">Name</label>
                <input class="form-control" [(ngModel)]="person.name" name="name" required />
              </div>
              <div class="col-md-4">
                <label class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  [(ngModel)]="person.email"
                  name="email"
                  required
                />
              </div>
              <div class="col-md-3">
                <label class="form-label">Phone</label>
                <input class="form-control" [(ngModel)]="person.phone" name="phone" required />
              </div>
              <div class="col-md-1 d-grid">
                <button type="submit" class="btn btn-join btn-lg">Add</button>
              </div>
            </form>
            <div class="mt-3">
              <div class="list-group">
                <div
                  class="list-group-item d-flex align-items-center justify-content-between"
                  *ngFor="let p of company?.personnel || []"
                >
                  <div class="flex-grow-1">
                    <ng-container *ngIf="editingId !== p.id; else editRow">
                      <div class="fw-semibold">{{ p.name }}</div>
                      <div class="small text-secondary">{{ p.email }} ‚Ä¢ {{ p.phone }}</div>
                    </ng-container>
                    <ng-template #editRow>
                      <div class="row g-2">
                        <div class="col-md-4">
                          <input
                            class="form-control"
                            [(ngModel)]="editModel.name"
                            name="ename{{ p.id }}"
                          />
                        </div>
                        <div class="col-md-4">
                          <input
                            type="email"
                            class="form-control"
                            [(ngModel)]="editModel.email"
                            name="eemail{{ p.id }}"
                          />
                        </div>
                        <div class="col-md-3">
                          <input
                            class="form-control"
                            [(ngModel)]="editModel.phone"
                            name="ephone{{ p.id }}"
                          />
                        </div>
                      </div>
                    </ng-template>
                  </div>
                  <div class="d-flex gap-2">
                    <ng-container *ngIf="editingId !== p.id; else editBtns">
                      <button class="btn btn-sm btn-outline-secondary" (click)="startEdit(p)">
                        Edit
                      </button>
                      <button class="btn btn-sm btn-outline-danger" (click)="removePersonnel(p.id)">
                        Remove
                      </button>
                    </ng-container>
                    <ng-template #editBtns>
                      <button class="btn btn-sm btn-join" (click)="saveEdit()">Save</button>
                      <button class="btn btn-sm btn-outline-secondary" (click)="cancelEdit()">
                        Cancel
                      </button>
                    </ng-template>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div> -->
      </div>

      <aside class="col-lg-4">
        <div class="ad-slot">Advertisement</div>
      </aside>
    </div>
  </div>

  <div *ngIf="!isLoading && !acc" class="container py-5">
    <h2 class="h5">No provider account found</h2>
    <a routerLink="/provider/register" class="btn btn-join btn-lg mt-2">Register now</a>
  </div>
</section>
